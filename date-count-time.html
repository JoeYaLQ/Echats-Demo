<!DOCTYPE html>
<html lang="zn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>❤Joe🐇</title>
<link href="./static/bootstrap-5.3.2/css/bootstrap.css" rel="stylesheet">
<script src="./static/bootstrap-5.3.2/js/bootstrap.bundle.min.js"></script>
<script src="./static/js/jquery-3.6.0.js"></script>
<script src="./static/js/echarts.min.js"></script>
<script src="./static/js/utils.js"></script>
<!--引|入Day.js库 -->
<script src="https://unpkg.com/dayjs"></script>
<style>
    
</style>
</head>
<body>

    <div id="headerContent"></div>
    <script type="text/javascript">  $("#headerContent").load("./header.html");  </script>
    <div id="container" style="height: 500px;width: 100%;padding: 30px 20px;"></div>
    <div class="px-4 pb-5">
        <h3 class="fw-bold">当前显示数据：</h3>
        <p class="operationDate"></p>
        <p class="cumDays"></p>
        <p class="avg"></p> 
        <p class="lastTime"></p>
        <span class="W p-2 border border-2 border-primary rounded-3"></span>
        <span class="Y p-2 border border-2 border-primary rounded-3 mx-3"></span>
        <br>
        <br>
        <span class="nS p-2 border border-2 border-primary rounded-3"></span>
        <span class="dream p-2 border border-2 border-primary rounded-3 mx-3"></span>
        <br>
        <br>
        <span class="sum p-2 border border-2 border-primary rounded-3"></span>
    </div>
    
<script type="text/javascript">
    var dom = document.getElementById('container');
    // 操作时间
    var operationDate = [
        '2024-10-04','2024-10-05','2024-10-06','2024-10-10',
        '2024-10-13 20:00:00','2024-10-17 1:00:00','2024-10-23 23:00:00',
        '2024-11-02 01:39:59','2024-11-02 19:59:59', '2024-11-03 15:29:59',
        '2024-11-04 00:53:59','2024-11-05 00:53:59','2024-11-05 22:33:59',
        '2024-11-10 03:33:59','2024-11-10 15:33:59','2024-11-15 5:33:59',
        '2024-11-16 00:33:59','2024-11-23 03:33:59','2024-11-24 22:53:59',
        '2024-11-26 00:23:59','2024-11-30 15:03:59','2024-12-01 11:13:59',
        '2024-12-02 00:13:59','2024-12-07 10:55:59','2024-12-09 00:13:59',
        '2024-12-14 15:00:59','2024-12-15 09:13:59','2024-12-22 00:13:59',
        '2024-12-28 01:43:59','2024-12-28 11:43:59','2024-12-29 11:13:59',
        '2024-12-29 0016:30:59',
    ];
    // 时长数据
    var duration =[
        { value: 0.75, itemStyle: { color: '#f12edf' }},
        { value: 0.8, itemStyle: { color: '#f12edf' }},
        -2.5,-1.25,-3,-2,-1.5,
        { value: 0.4, itemStyle: { color: '#f12edf' }},
        { value: 0.3, itemStyle: { color: '#f12edf' }},
        { value: 0.3, itemStyle: { color: '#f12edf' }},
        -0.9,-2.5,-0.5,-2.3,-0.8,-0.25,-1.25,
        { value: 0.25, itemStyle: { color: '#f12edf' }},
        -0.5,-1,
        { value: 0.25, itemStyle: { color: '#f12edf' }},
        { value: 0.8, itemStyle: { color: '#f12edf' }},
        -1,
        { value: 0.8, itemStyle: { color: '#f12edf' }},
        -1.25,-1.5,
        { value: 1, itemStyle: { color: '#1ba035' }},
        -1,
        { value: 0.3, itemStyle: { color: '#f12edf' }},
        { value: 0.5, itemStyle: { color: '#adb5bd' }},
        { value: 0.8, itemStyle: { color: '#f12edf' }},
        { value: 0.5, itemStyle: { color: '#f12edf' }},
    ];
    console.log(`output->`,duration)
    var myChart = echarts.init(dom, null, {
        renderer: 'canvas',
        useDirtyRect: false
    });

    var option = {
        // 提示词
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                label: {
                    show: true
                }
            }
        },
        // 工具箱
        toolbox: {
            show: true,
            feature: {
                mark: { show: true },
                dataView: { show: true, readOnly: false },
                magicType: { show: true, type: ['line', 'bar'] },
                restore: { show: true },
                saveAsImage: { show: true }
            }
        },
        calculable: true,
        legend: { },
        grid: {
            top: 50,
            left: 10,
            bottom: 50,
            containLabel : true,
        },
        xAxis: {
            type: 'category',
            name: 'Date',
            data: operationDate,
        },
        yAxis: {
            type: 'value',
            name: 'duration(h)',
            axisLine: {
                show: true,
            },
        },  
        dataZoom: [
            {
                show: true,
                start: 0,
                end: 100
            },
        ],
        series: [
            {
                name: 'Frequency',
                type: 'bar',
                data: duration,
                label: {
                    show: true,
                },
            },
        ]
    };
    myChart.setOption(option);
    // 更改P标签的内容
    var ya = 0;
    var wy = 0;
    var wangY = 0;

    duration.forEach(item => {
        if (typeof item === 'object' && item.itemStyle && item.itemStyle.color) {
            if (item.itemStyle.color === '#f12edf') {
                ya++;
            } else if (item.itemStyle.color === '#1ba035') {
                wy++;
            } else if (item.itemStyle.color === '#adb5bd') {
                wangY++;
            }
        }
    });
    // const ya = duration.filter(item => typeof item === 'object' && item !== null).length;
    console.log(`output->ya `,ya,operationDate.length )
    const wang = operationDate.length - ya - wy - wangY;
    const sum = operationDate.length - wangY
    // $('.operationDate').html('时间段：' + operationDate[0] + ' To ' + nowTime)

    $('.operationDate').html('Duration：' + operationDate[0] + ' to ' + dayjs().format("YYYY-MM-DD") + ' ; ' )
    $('.cumDays').html('Cumulative days：' + dayjs().diff(operationDate[0],'day') + ' ; ' )
    $('.avg').html('SVG：' + dayjs().diff(operationDate[0],'day') / sum + ' ; ')
    // 距离上一次时间间隔 用 dayjs把operationDate.at(-1)的值转换为时间对象在进行格式化处理，计算其差值
    $('.lastTime').html('lastTime：' + dayjs().diff(dayjs(operationDate.at(-1)).format('YYYY-MM-DD'),'day') + ' ; ')
    $('.Y').html('🐇：' + ya + ' ; ')
    $('.W').html('🐉：' + wang + ' ; ')
    $('.nS').html('♥️：' + wangY + ' ; ')
    $('.sum').html('🐇+🐉+😴：' + sum + ' ; ')
    $('.dream').html('😴：' + wy + ' ; ')
    
    window.addEventListener('resize', myChart.resize);
    init()
</script>
</body>
</html>